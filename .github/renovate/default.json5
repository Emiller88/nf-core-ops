{
    $schema: "https://docs.renovatebot.com/renovate-schema.json",
    extends: ["config:best-practices", ":automergeDigest", ":automergeBranch"],
    vulnerabilityAlerts: {
        labels: ["security"],
        schedule: "at any time",
    },
    prHourlyLimit: 3,
    platform: "github",
    onboarding: false,
    dependencyDashboard: true,
    dependencyDashboardTitle: "Renovate Dashboard ðŸ¤–",
    suppressNotifications: ["prIgnoreNotification"],
    rebaseWhen: "conflicted",
    reviewers: ["team:modules"],
    assigneesFromCodeOwners: true,
    gitAuthor: "nf-core-bot <renovate@nf-co.re>",
    "pre-commit": {
        enabled: true,
    },
    customDatasources: [
        "nextflow-plugin": {
            "defaultRegistryUrlTemplate": "https://raw.githubusercontent.com/nextflow-io/plugins/main/plugins.json"
            "format": "json",
            "versioning": "semver",
            "transformTemplate": [
                "$[id = 'nf-validation']"
            ]
        }
    ],
    customManagers: [
        {
            customType: "regex",
            description: "Process Containers dependencies",
            fileMatch: ["(^|/)main\\.nf$"],
            matchStrings: [
                "\\s+'(?<depName>\\S+):(?<currentValue>.*\\-.*)' }\"\n",
            ],
            datasourceTemplate: "docker",
        },
        {
            customType: "regex",
            description: "Upgrade conda dependencies",
            fileMatch: ["(^|/)environment(.*).ya?ml$"],
            matchStrings: [
                "#\\s*renovate\\s+datasource=conda\\s+depName=(?<depName>.*?)\\s+-\\s*[\\w-]+\\s*==?\\s*\"?(?<currentValue>.*)\"?",
                "# renovate: datasource=conda depName=(?<depName>.*?)\\s+-\\s*[\\w-]+\\s*==?\\s*\"?(?<currentValue>.*)\"?"
            ],
            datasourceTemplate: "conda"
        },
        {
            customType: "regex",
            description: "Upgrade pypi dependencies inside conda environment files",
            fileMatch: ["(^|/)environment(.*).ya?ml$"],
            matchStrings: [
                "# renovate datasource=pypi\\s+-\\s*(?<depName>[\\w-]+)\\s*(\\[[\\w,\\s]+\\])?\\s*==?\\s*(?<currentValue>.*)",
                "# renovate: datasource=pypi\\s+-\\s*(?<depName>[\\w-]+)\\s*(\\[[\\w,\\s]+\\])?\\s*==?\\s*(?<currentValue>.*)"
            ],
            datasourceTemplate: "pypi"
        },
        {
            customType: "regex",
            description: "Check that nf-valdiation plugin is pinned in nextflow.config, i.e. `plugins {id 'nf-validation@1.1.3'}`",
            fileMatch: ["(^|/)nextflow\\.config$"],
            matchStrings: [
                "\\s+id\\s'<depName>@(?<currentValue>.*)'"
            ],
            datasourceTemplate: "custom.nextflow-plugin",
        },
        }
    ],
    packageRules: [
        {
            matchDatasources: ["docker"],
            registryUrls: ["quay.io"],
        },
    ],
}
